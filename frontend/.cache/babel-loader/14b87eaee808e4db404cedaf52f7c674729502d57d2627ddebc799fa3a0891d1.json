{"ast":null,"code":"import axios from 'axios';\n\n// Create an axios instance with the base URL\nconst api = axios.create({\n  baseURL: 'http://127.0.0.1:8000/',\n  // Updated to match the Django server root\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Request interceptor - adds auth token if available\napi.interceptors.request.use(config => {\n  // Get token from localStorage\n  const token = localStorage.getItem('token');\n\n  // Check if token exists\n  if (token) {\n    console.log(`API Request: Using token for ${config.url}`);\n\n    // Check token format - use Bearer for JWT tokens\n    if (token.startsWith('eyJ')) {\n      // JWT format tokens should use Bearer prefix\n      config.headers.Authorization = `Bearer ${token}`;\n      console.log('Using JWT token with Bearer prefix');\n    } else {\n      // Other token formats use the Django REST Framework Token format\n      config.headers.Authorization = `Token ${token}`;\n      console.log('Using Django REST Framework Token format');\n    }\n\n    // Add detailed debug info for troubleshooting\n    console.log('Authorization header format:', config.headers.Authorization.includes(' ') ? `${config.headers.Authorization.split(' ')[0]} + token` : 'Direct token (no prefix)');\n    console.log('Token length:', token.length);\n  } else {\n    console.log('API Request: No token found');\n  }\n  console.log('Sending token:', token);\n  return config;\n}, error => {\n  console.error('Request interceptor error:', error);\n  return Promise.reject(error);\n});\n\n// Response interceptor - handles auth errors\napi.interceptors.response.use(response => {\n  return response;\n}, error => {\n  // Handle 401 Unauthorized errors\n  if (error.response && error.response.status === 401) {\n    console.error('401 Unauthorized error from API:', {\n      url: error.config.url,\n      method: error.config.method,\n      headers: error.config.headers.Authorization ? error.config.headers.Authorization.substring(0, 20) + '...' : 'none',\n      data: error.response.data\n    });\n\n    // Log the full error response for debugging\n    console.error('Full 401 response:', {\n      detail: error.response.data.detail || 'No detail provided',\n      message: error.response.data.message || 'No message provided',\n      rawData: JSON.stringify(error.response.data)\n    });\n\n    // Check if token was invalid\n    if (error.response.data && (error.response.data.detail === 'Invalid token' || error.response.data.message === 'Invalid token')) {\n      console.error('Token was rejected by server - may need to log in again');\n\n      // Keep the token for now, but log the issue\n      // Don't automatically clear it to prevent logout loops\n    }\n  }\n  return Promise.reject(error);\n});\n\n// Auth functions\nexport const loginUser = async ({\n  email,\n  password\n}) => {\n  try {\n    var _lastError$response;\n    console.log('Login attempt with data:', {\n      email,\n      password: '********' // Mask password in logs for security\n    });\n\n    // These are the exact endpoints found in your Django backend code\n    const possibleEndpoints = ['http://127.0.0.1:8000/api/auth/login/',\n    // From backend.urls.py \n    'http://127.0.0.1:8000/users/api/login/',\n    // From users.urls.py\n    'http://127.0.0.1:8000/apiV1/api/auth/login/',\n    // From chatbot.urls.py\n    'http://localhost:8000/api/auth/login/',\n    // Try with localhost instead of IP\n    'http://localhost:8000/users/api/login/', 'http://localhost:8000/apiV1/api/auth/login/'];\n    let lastError = null;\n\n    // Try each endpoint until one succeeds\n    for (const endpoint of possibleEndpoints) {\n      try {\n        console.log(`Attempting login with endpoint: ${endpoint}`);\n        const response = await axios.post(endpoint, {\n          email,\n          password\n        });\n        console.log(`Login successful with endpoint: ${endpoint}`);\n        console.log('Login response structure:', Object.keys(response.data).join(', '));\n\n        // Extract token from various possible formats\n        let token = null;\n        if (response.data.token) {\n          token = response.data.token;\n          console.log('Found token in response.data.token');\n        } else if (response.data.access) {\n          token = response.data.access;\n          console.log('Found token in response.data.access');\n        } else if (response.data.key) {\n          token = response.data.key;\n          console.log('Found token in response.data.key');\n        } else if (typeof response.data === 'string') {\n          // Sometimes the API returns the token directly as a string\n          token = response.data;\n          console.log('Response data is a string, using as token');\n        } else {\n          // Loop through all properties to find one that might be a token\n          for (const key in response.data) {\n            if (typeof response.data[key] === 'string' && (response.data[key].length > 20 || key.toLowerCase().includes('token'))) {\n              token = response.data[key];\n              console.log(`Found possible token in response.data.${key}`);\n              break;\n            }\n          }\n        }\n        if (!token) {\n          console.error('No token found in login response:', response.data);\n          throw new Error('Authentication failed: No token in response');\n        }\n\n        // Store the token\n        localStorage.setItem('token', token);\n\n        // Store user info if available in the response\n        if (response.data.user) {\n          console.log('User data found in response:', Object.keys(response.data.user).join(', '));\n          const userData = response.data.user;\n\n          // Create a user object to store in localStorage\n          const userObj = {\n            id: userData.id || 'unknown',\n            email: userData.email || email,\n            name: userData.fullName || userData.name || userData.username || email.split('@')[0],\n            authenticated: true\n          };\n          localStorage.setItem('user', JSON.stringify(userObj));\n        } else {\n          // If we don't have user info, store the email we logged in with\n          if (typeof email === 'string') {\n            sessionStorage.setItem('lastLoginEmail', email);\n\n            // Create a basic user object in localStorage\n            const userObj = {\n              email: email,\n              name: email.split('@')[0],\n              authenticated: true\n            };\n            localStorage.setItem('user', JSON.stringify(userObj));\n          }\n        }\n        return {\n          ...response.data,\n          token: token,\n          // Ensure token is in the returned data\n          success: true\n        };\n      } catch (error) {\n        console.error(`Login failed with endpoint ${endpoint}:`, error.message);\n        lastError = error;\n        // Continue to the next endpoint if this one failed\n      }\n    }\n\n    // If we've reached this point, all endpoints failed\n    console.error('Login error:', lastError);\n    console.error('Error details:', ((_lastError$response = lastError.response) === null || _lastError$response === void 0 ? void 0 : _lastError$response.data) || lastError.message);\n\n    // Extract meaningful error message if available\n    let errorMessage = 'Login failed. Make sure your Django server is running and check your credentials.';\n    if (lastError.response) {\n      if (lastError.response.data.message) {\n        errorMessage = lastError.response.data.message;\n      } else if (lastError.response.data.error) {\n        errorMessage = lastError.response.data.error;\n      } else if (typeof lastError.response.data === 'string') {\n        errorMessage = lastError.response.data;\n      } else if (lastError.response.data.detail) {\n        errorMessage = lastError.response.data.detail;\n      } else if (lastError.response.data.non_field_errors) {\n        errorMessage = lastError.response.data.non_field_errors.join('. ');\n      }\n    }\n    throw new Error(errorMessage);\n  } catch (error) {\n    console.error('Login error:', error);\n    throw new Error(error.message || 'Login failed. Check server connection.');\n  }\n};\nexport const signupUser = async userData => {\n  try {\n    var _lastError$response2;\n    console.log('Signup attempt with data:', {\n      ...userData,\n      password: userData.password ? '********' : undefined // Mask password in logs for security\n    });\n\n    // These are the exact endpoints found in your Django backend code\n    const possibleEndpoints = ['http://127.0.0.1:8000/api/auth/signup/',\n    // From backend.urls.py\n    'http://127.0.0.1:8000/users/api/register/',\n    // From users.urls.py\n    'http://localhost:8000/api/auth/signup/',\n    // Try with localhost instead of IP\n    'http://localhost:8000/users/api/register/'];\n    let lastError = null;\n\n    // Try each endpoint until one succeeds\n    for (const endpoint of possibleEndpoints) {\n      try {\n        console.log(`Attempting signup with endpoint: ${endpoint}`);\n\n        // Format the data according to what your backend expects\n        // LoginSerializer requires email and password\n        // RegisterSerializer requires email, username, and password\n        const adaptedUserData = {\n          ...userData,\n          // If username is not provided, use email or part of email as username\n          username: userData.username || userData.email.split('@')[0]\n        };\n        const response = await axios.post(endpoint, adaptedUserData);\n        console.log(`Signup successful with endpoint: ${endpoint}`);\n        console.log('Signup response:', response.data);\n\n        // If signup was successful, return success data\n        return {\n          success: true,\n          data: response.data,\n          message: 'Signup successful! You can now log in.'\n        };\n      } catch (error) {\n        console.error(`Signup failed with endpoint ${endpoint}:`, error.message);\n        lastError = error;\n        // Continue to the next endpoint if this one failed\n      }\n    }\n\n    // If we've reached this point, all endpoints failed\n    console.error('Signup error:', lastError);\n    console.error('Error details:', ((_lastError$response2 = lastError.response) === null || _lastError$response2 === void 0 ? void 0 : _lastError$response2.data) || lastError.message);\n\n    // Extract meaningful error message if available\n    let errorMessage = 'Signup failed. Make sure your Django server is running and try again.';\n    if (lastError.response) {\n      if (lastError.response.data.message) {\n        errorMessage = lastError.response.data.message;\n      } else if (lastError.response.data.error) {\n        errorMessage = lastError.response.data.error;\n      } else if (typeof lastError.response.data === 'string') {\n        errorMessage = lastError.response.data;\n      } else if (lastError.response.data.detail) {\n        errorMessage = lastError.response.data.detail;\n      } else if (lastError.response.data.non_field_errors) {\n        errorMessage = lastError.response.data.non_field_errors.join('. ');\n      } else {\n        // Look for field-specific validation errors\n        const validationErrors = [];\n        for (const field in lastError.response.data) {\n          if (Array.isArray(lastError.response.data[field])) {\n            validationErrors.push(`${field}: ${lastError.response.data[field].join('. ')}`);\n          }\n        }\n        if (validationErrors.length > 0) {\n          errorMessage = validationErrors.join('. ');\n        }\n      }\n    }\n    throw new Error(errorMessage);\n  } catch (error) {\n    console.error('Signup error:', error);\n    throw new Error(error.message || 'Signup failed. Check server connection.');\n  }\n};\n\n// User profile\nexport const getUserProfile = async () => {\n  try {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      throw new Error('Authentication required');\n    }\n\n    // Determine the correct authentication header based on token format\n    let headers = {};\n    if (token.startsWith('eyJ')) {\n      // For JWT, try direct token approach (no prefix)\n      headers.Authorization = token;\n      console.log('getUserProfile: Using direct JWT token (no prefix)');\n    } else {\n      // Use Token format for other types\n      headers.Authorization = `Token ${token}`;\n      console.log('getUserProfile: Using Django REST Framework Token format');\n    }\n\n    // Try multiple profile endpoints that might exist\n    const possibleEndpoints = ['/apiV1/profile/', '/apiV1/user/profile/', '/apiV1/user/', '/api/auth/profile/', '/api/auth/user/', '/api/user/profile/', '/api/user/', '/api/profile/', '/api/me/', '/admin/' // Try admin endpoint as a test for authentication\n    ];\n    let lastError = null;\n    let userData = null;\n\n    // Try each endpoint until one works\n    for (const endpoint of possibleEndpoints) {\n      try {\n        console.log(`Trying to fetch profile from ${endpoint}`);\n        const response = await api.get(endpoint, {\n          headers\n        });\n        if (response.status === 200 && response.data) {\n          console.log(`Profile found at ${endpoint}:`, response.status);\n          userData = response.data;\n          break;\n        }\n      } catch (endpointError) {\n        console.log(`Profile not found at ${endpoint}:`, endpointError.response ? endpointError.response.status : 'network error');\n        lastError = endpointError;\n        // Continue to the next endpoint\n      }\n    }\n\n    // If we found user data from any endpoint\n    if (userData) {\n      console.log('Profile data found:', Object.keys(userData).join(', '));\n\n      // Store key user info in session storage for fallback\n      if (userData.email) {\n        sessionStorage.setItem('lastLoginEmail', userData.email);\n      }\n      if (userData.name) {\n        sessionStorage.setItem('userName', userData.name);\n      } else if (userData.username) {\n        sessionStorage.setItem('userName', userData.username);\n      } else if (userData.first_name) {\n        const fullName = userData.last_name ? `${userData.first_name} ${userData.last_name}` : userData.first_name;\n        sessionStorage.setItem('userName', fullName);\n      }\n      return userData;\n    }\n\n    // If we get here, no endpoints worked but we have a token\n    // Create a fallback profile based on stored session data\n    console.log('No profile endpoints successful, using fallback data');\n    const email = sessionStorage.getItem('lastLoginEmail');\n    const name = sessionStorage.getItem('userName');\n    if (email) {\n      return {\n        email: email,\n        name: name || 'User',\n        profile_picture: null\n      };\n    }\n\n    // If we have no email, re-throw the last error\n    throw lastError || new Error('Failed to fetch profile from all endpoints');\n  } catch (error) {\n    console.error('Error fetching user profile:', error.response ? `${error.response.status}: ${JSON.stringify(error.response.data)}` : error.message);\n\n    // Create a fallback user object if profile fetch fails\n    const email = sessionStorage.getItem('lastLoginEmail');\n    if (email) {\n      return {\n        email: email,\n        name: sessionStorage.getItem('userName') || 'User',\n        profile_picture: null\n      };\n    }\n    throw error;\n  }\n};\n\n// Directories\nexport const getDirectories = async () => {\n  try {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      throw new Error('Authentication required');\n    }\n\n    // Try with trailing slash first (Django often requires this)\n    const response = await api.get('/apiV1/directories/', {\n      headers: {\n        Authorization: `Token ${token}` // Using Token format for Django REST Framework\n      }\n    });\n    console.log('Directories response:', response.status, response.data);\n    return response.data;\n  } catch (error) {\n    // If we get a 404 with trailing slash, try without\n    if (error.response && error.response.status === 404) {\n      try {\n        const response = await api.get('/apiV1/directories', {\n          headers: {\n            Authorization: `Token ${token}`\n          }\n        });\n        console.log('Directories response (without trailing slash):', response.status, response.data);\n        return response.data;\n      } catch (retryError) {\n        console.error('Error fetching directories (retry):', retryError.response ? retryError.response.status : retryError.message);\n        throw retryError;\n      }\n    }\n    console.error('Error fetching directories:', error.response ? error.response.status : error.message);\n\n    // Return some mock directory data if the API fails\n    return [{\n      id: 1,\n      name: 'Documents',\n      path: '/documents',\n      color: '#4285F4'\n    }, {\n      id: 2,\n      name: 'Images',\n      path: '/images',\n      color: '#34A853'\n    }, {\n      id: 3,\n      name: 'Projects',\n      path: '/projects',\n      color: '#FBBC05'\n    }, {\n      id: 4,\n      name: 'Reports',\n      path: '/reports',\n      color: '#EA4335'\n    }];\n  }\n};\n\n// Chat API Functions\nexport const getChatHistory = async () => {\n  try {\n    // For initial implementation, we'll create a welcome message\n    return [{\n      id: 'welcome',\n      sender: 'bot',\n      content: 'Welcome to FarmSphere.AI, your intelligent farming assistant. How can I help you today?',\n      timestamp: new Date().toISOString()\n    }];\n  } catch (error) {\n    console.error('Error fetching chat history:', error);\n    return [];\n  }\n};\nexport const sendChatMessage = async message => {\n  try {\n    const token = localStorage.getItem('token');\n\n    // Log token status for debugging\n    console.log('Sending chat message with token:', token ? 'Token exists' : 'No token');\n\n    // Set up headers with proper authentication\n    let headers = {};\n    if (token) {\n      if (token.startsWith('eyJ')) {\n        headers.Authorization = `Bearer ${token}`;\n        console.log('Using JWT Bearer token format');\n      } else {\n        headers.Authorization = `Token ${token}`;\n        console.log('Using Django Token format');\n      }\n    }\n\n    // Log the actual authorization header for debugging\n    console.log('Authorization header:', headers.Authorization || 'None');\n\n    // Make request with explicit full URL to avoid any path issues\n    const response = await axios.post('http://127.0.0.1:8000/apiV1/chat/', {\n      message\n    }, {\n      headers\n    });\n    console.log('Chat response received:', response.data);\n    return {\n      content: response.data.response,\n      sender: 'bot',\n      timestamp: response.data.timestamp || new Date().toISOString()\n    };\n  } catch (error) {\n    console.error('Error sending chat message:', error);\n\n    // Check for specific auth errors and handle appropriately\n    if (error.response && error.response.status === 401) {\n      console.warn('Authentication failed - you may need to log in again');\n      // Optional: Redirect to login or reset auth state\n      // localStorage.removeItem('token');\n      // window.location.href = '/login';\n    }\n    throw new Error('Failed to send message. Please try again.');\n  }\n};\n\n// Function to diagnose API endpoints\nexport const checkApiEndpoints = async () => {\n  const token = localStorage.getItem('token');\n  if (!token) {\n    console.error('No authentication token available');\n    return {\n      authenticated: false,\n      endpoints: []\n    };\n  }\n\n  // Prepare headers\n  const headers = {\n    Authorization: `Token ${token}`\n  };\n\n  // List of endpoints to test\n  const endpoints = [\n  // Common API endpoints\n  {\n    method: 'GET',\n    url: '/api/auth/profile/'\n  }, {\n    method: 'GET',\n    url: '/api/directories/'\n  }, {\n    method: 'GET',\n    url: '/api/chat/'\n  }, {\n    method: 'POST',\n    url: '/api/chat/',\n    data: {\n      message: 'test'\n    }\n  },\n  // V1 API endpoints \n  {\n    method: 'GET',\n    url: '/apiV1/profile/'\n  }, {\n    method: 'GET',\n    url: '/apiV1/directories/'\n  }, {\n    method: 'GET',\n    url: '/apiV1/ping/'\n  }, {\n    method: 'POST',\n    url: '/apiV1/chat/',\n    data: {\n      message: 'test'\n    }\n  },\n  // Azure-specific endpoints (if any)\n  {\n    method: 'GET',\n    url: '/apiV1/azure/status/'\n  }];\n  const results = [];\n\n  // Test each endpoint\n  for (const endpoint of endpoints) {\n    try {\n      console.log(`Testing ${endpoint.method} ${endpoint.url}...`);\n      const config = {\n        method: endpoint.method,\n        url: endpoint.url,\n        headers: headers,\n        data: endpoint.data || null\n      };\n      const response = await axios(config);\n      results.push({\n        endpoint: endpoint.url,\n        method: endpoint.method,\n        status: response.status,\n        available: true,\n        data: typeof response.data === 'object' ? 'Object received' : 'Data received'\n      });\n      console.log(`✅ ${endpoint.method} ${endpoint.url} - Status: ${response.status}`);\n    } catch (error) {\n      var _error$response, _error$response2, _error$response3;\n      results.push({\n        endpoint: endpoint.url,\n        method: endpoint.method,\n        status: ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) || 'Network Error',\n        available: false,\n        error: ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data) || error.message\n      });\n      console.log(`❌ ${endpoint.method} ${endpoint.url} - Error: ${((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.status) || error.message}`);\n    }\n  }\n\n  // Log the summary\n  const availableEndpoints = results.filter(e => e.available);\n  console.log(`API Endpoint Check Summary: ${availableEndpoints.length}/${endpoints.length} endpoints available`);\n  console.table(results);\n  return {\n    authenticated: true,\n    endpoints: results,\n    availableCount: availableEndpoints.length,\n    totalCount: endpoints.length\n  };\n};\n\n/**\n * Tests a specific endpoint and returns detailed status information\n * @param {string} endpoint - The endpoint path to test (e.g., '/api/chat/')\n * @returns {Object} - Object containing status information\n */\nexport const testEndpoint = async endpoint => {\n  const baseUrl = 'http://127.0.0.1:8000'; // Django backend URL\n  const url = `${baseUrl}${endpoint}`;\n  try {\n    // Get token if available and use appropriate format\n    const token = localStorage.getItem('token');\n    let headers = {};\n    if (token) {\n      if (token.startsWith('eyJ')) {\n        // For JWT, try direct token approach (no prefix)\n        headers.Authorization = token;\n        console.log('Using direct JWT token (no prefix)');\n      } else {\n        // Other token formats use the Django REST Framework Token format\n        headers.Authorization = `Token ${token}`;\n        console.log('Using Django REST Framework Token format');\n      }\n    }\n    console.log(`Testing endpoint: ${url}`);\n    console.log('Authorization header:', token ? headers.Authorization.substring(0, 15) + '...' : 'None');\n\n    // For GET endpoints\n    const response = await axios.get(url, {\n      headers,\n      // Don't throw error on non-2xx responses - we want to handle them ourselves\n      validateStatus: () => true\n    });\n    console.log(`Endpoint ${url} response:`, response.status, response.statusText);\n\n    // A 404 means the server is running but endpoint doesn't exist\n    if (response.status === 404) {\n      return {\n        url,\n        status: 404,\n        available: false,\n        serverRunning: true,\n        message: \"Endpoint not found, but server is running\",\n        data: response.data\n      };\n    }\n\n    // Auth errors\n    if (response.status === 401 || response.status === 403) {\n      return {\n        url,\n        status: response.status,\n        available: false,\n        authError: true,\n        message: response.status === 401 ? \"Unauthorized - Invalid or missing token\" : \"Forbidden\",\n        data: response.data\n      };\n    }\n\n    // Success (2xx) responses\n    if (response.status >= 200 && response.status < 300) {\n      return {\n        url,\n        status: response.status,\n        available: true,\n        message: \"Endpoint available\",\n        data: response.data\n      };\n    }\n\n    // Other responses\n    return {\n      url,\n      status: response.status,\n      available: false,\n      message: `Endpoint responded with: ${response.status} ${response.statusText}`,\n      data: response.data\n    };\n  } catch (error) {\n    var _error$response4;\n    console.error(`Error testing endpoint ${url}:`, error);\n\n    // Network errors (server not running)\n    if (error.code === 'ERR_NETWORK') {\n      return {\n        url,\n        status: 'Network Error',\n        available: false,\n        serverRunning: false,\n        message: \"Server not running or network error\",\n        error: error.message\n      };\n    }\n    return {\n      url,\n      status: ((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.status) || 'Error',\n      available: false,\n      message: `Error: ${error.message}`,\n      error: error.message\n    };\n  }\n};\nexport default api;","map":{"version":3,"names":["axios","api","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","console","log","url","startsWith","Authorization","includes","split","length","error","Promise","reject","response","status","method","substring","data","detail","message","rawData","JSON","stringify","loginUser","email","password","_lastError$response","possibleEndpoints","lastError","endpoint","post","Object","keys","join","access","key","toLowerCase","Error","setItem","user","userData","userObj","id","name","fullName","username","authenticated","sessionStorage","success","errorMessage","non_field_errors","signupUser","_lastError$response2","undefined","adaptedUserData","validationErrors","field","Array","isArray","push","getUserProfile","get","endpointError","first_name","last_name","profile_picture","getDirectories","retryError","path","color","getChatHistory","sender","content","timestamp","Date","toISOString","sendChatMessage","warn","checkApiEndpoints","endpoints","results","available","_error$response","_error$response2","_error$response3","availableEndpoints","filter","e","table","availableCount","totalCount","testEndpoint","baseUrl","validateStatus","statusText","serverRunning","authError","_error$response4","code"],"sources":["C:/Users/STSC/Downloads/Agent-Backend-main (3)/my-app/src/services/api.js"],"sourcesContent":["import axios from 'axios';\n\n// Create an axios instance with the base URL\nconst api = axios.create({\n  baseURL: 'http://127.0.0.1:8000/', // Updated to match the Django server root\n  headers: {\n    'Content-Type': 'application/json',\n  }\n});\n\n// Request interceptor - adds auth token if available\napi.interceptors.request.use(\n  (config) => {\n    // Get token from localStorage\n    const token = localStorage.getItem('token');\n    \n    // Check if token exists\n    if (token) {\n      console.log(`API Request: Using token for ${config.url}`);\n      \n      // Check token format - use Bearer for JWT tokens\n      if (token.startsWith('eyJ')) {\n        // JWT format tokens should use Bearer prefix\n        config.headers.Authorization = `Bearer ${token}`;\n        console.log('Using JWT token with Bearer prefix');\n      } else {\n        // Other token formats use the Django REST Framework Token format\n        config.headers.Authorization = `Token ${token}`;\n        console.log('Using Django REST Framework Token format');\n      }\n      \n      // Add detailed debug info for troubleshooting\n      console.log('Authorization header format:', config.headers.Authorization.includes(' ') ? \n        `${config.headers.Authorization.split(' ')[0]} + token` : 'Direct token (no prefix)');\n      console.log('Token length:', token.length);\n    } else {\n      console.log('API Request: No token found');\n    }\n    \n    console.log('Sending token:', token);\n    \n    return config;\n  },\n  (error) => {\n    console.error('Request interceptor error:', error);\n    return Promise.reject(error);\n  }\n);\n\n// Response interceptor - handles auth errors\napi.interceptors.response.use(\n  (response) => {\n    return response;\n  },\n  (error) => {\n    // Handle 401 Unauthorized errors\n    if (error.response && error.response.status === 401) {\n      console.error('401 Unauthorized error from API:', {\n        url: error.config.url,\n        method: error.config.method,\n        headers: error.config.headers.Authorization ? \n          error.config.headers.Authorization.substring(0, 20) + '...' : 'none',\n        data: error.response.data\n      });\n      \n      // Log the full error response for debugging\n      console.error('Full 401 response:', {\n        detail: error.response.data.detail || 'No detail provided',\n        message: error.response.data.message || 'No message provided',\n        rawData: JSON.stringify(error.response.data)\n      });\n      \n      // Check if token was invalid\n      if (error.response.data && \n          (error.response.data.detail === 'Invalid token' || \n           error.response.data.message === 'Invalid token')) {\n        console.error('Token was rejected by server - may need to log in again');\n        \n        // Keep the token for now, but log the issue\n        // Don't automatically clear it to prevent logout loops\n      }\n    }\n    \n    return Promise.reject(error);\n  }\n);\n\n// Auth functions\nexport const loginUser = async ({ email, password }) => {\n  try {\n    console.log('Login attempt with data:', { \n      email,\n      password: '********' // Mask password in logs for security\n    });\n    \n    // These are the exact endpoints found in your Django backend code\n    const possibleEndpoints = [\n      'http://127.0.0.1:8000/api/auth/login/',     // From backend.urls.py \n      'http://127.0.0.1:8000/users/api/login/',    // From users.urls.py\n      'http://127.0.0.1:8000/apiV1/api/auth/login/', // From chatbot.urls.py\n      'http://localhost:8000/api/auth/login/',     // Try with localhost instead of IP\n      'http://localhost:8000/users/api/login/',\n      'http://localhost:8000/apiV1/api/auth/login/'\n    ];\n    \n    let lastError = null;\n    \n    // Try each endpoint until one succeeds\n    for (const endpoint of possibleEndpoints) {\n      try {\n        console.log(`Attempting login with endpoint: ${endpoint}`);\n        const response = await axios.post(endpoint, { email, password });\n        \n        console.log(`Login successful with endpoint: ${endpoint}`);\n        console.log('Login response structure:', Object.keys(response.data).join(', '));\n        \n        // Extract token from various possible formats\n        let token = null;\n        \n        if (response.data.token) {\n          token = response.data.token;\n          console.log('Found token in response.data.token');\n        } else if (response.data.access) {\n          token = response.data.access;\n          console.log('Found token in response.data.access');\n        } else if (response.data.key) {\n          token = response.data.key;\n          console.log('Found token in response.data.key');\n        } else if (typeof response.data === 'string') {\n          // Sometimes the API returns the token directly as a string\n          token = response.data;\n          console.log('Response data is a string, using as token');\n        } else {\n          // Loop through all properties to find one that might be a token\n          for (const key in response.data) {\n            if (\n              typeof response.data[key] === 'string' && \n              (response.data[key].length > 20 || key.toLowerCase().includes('token'))\n            ) {\n              token = response.data[key];\n              console.log(`Found possible token in response.data.${key}`);\n              break;\n            }\n          }\n        }\n        \n        if (!token) {\n          console.error('No token found in login response:', response.data);\n          throw new Error('Authentication failed: No token in response');\n        }\n        \n        // Store the token\n        localStorage.setItem('token', token);\n        \n        // Store user info if available in the response\n        if (response.data.user) {\n          console.log('User data found in response:', Object.keys(response.data.user).join(', '));\n          const userData = response.data.user;\n          \n          // Create a user object to store in localStorage\n          const userObj = {\n            id: userData.id || 'unknown',\n            email: userData.email || email,\n            name: userData.fullName || userData.name || userData.username || email.split('@')[0],\n            authenticated: true\n          };\n          \n          localStorage.setItem('user', JSON.stringify(userObj));\n        } else {\n          // If we don't have user info, store the email we logged in with\n          if (typeof email === 'string') {\n            sessionStorage.setItem('lastLoginEmail', email);\n            \n            // Create a basic user object in localStorage\n            const userObj = {\n              email: email,\n              name: email.split('@')[0],\n              authenticated: true\n            };\n            \n            localStorage.setItem('user', JSON.stringify(userObj));\n          }\n        }\n        \n        return {\n          ...response.data,\n          token: token, // Ensure token is in the returned data\n          success: true\n        };\n      } catch (error) {\n        console.error(`Login failed with endpoint ${endpoint}:`, error.message);\n        lastError = error;\n        // Continue to the next endpoint if this one failed\n      }\n    }\n    \n    // If we've reached this point, all endpoints failed\n    console.error('Login error:', lastError);\n    console.error('Error details:', lastError.response?.data || lastError.message);\n    \n    // Extract meaningful error message if available\n    let errorMessage = 'Login failed. Make sure your Django server is running and check your credentials.';\n    if (lastError.response) {\n      if (lastError.response.data.message) {\n        errorMessage = lastError.response.data.message;\n      } else if (lastError.response.data.error) {\n        errorMessage = lastError.response.data.error;\n      } else if (typeof lastError.response.data === 'string') {\n        errorMessage = lastError.response.data;\n      } else if (lastError.response.data.detail) {\n        errorMessage = lastError.response.data.detail;\n      } else if (lastError.response.data.non_field_errors) {\n        errorMessage = lastError.response.data.non_field_errors.join('. ');\n      }\n    }\n    \n    throw new Error(errorMessage);\n  } catch (error) {\n    console.error('Login error:', error);\n    throw new Error(error.message || 'Login failed. Check server connection.');\n  }\n};\n\nexport const signupUser = async (userData) => {\n  try {\n    console.log('Signup attempt with data:', { \n      ...userData,\n      password: userData.password ? '********' : undefined // Mask password in logs for security\n    });\n    \n    // These are the exact endpoints found in your Django backend code\n    const possibleEndpoints = [\n      'http://127.0.0.1:8000/api/auth/signup/',    // From backend.urls.py\n      'http://127.0.0.1:8000/users/api/register/', // From users.urls.py\n      'http://localhost:8000/api/auth/signup/',    // Try with localhost instead of IP\n      'http://localhost:8000/users/api/register/'\n    ];\n    \n    let lastError = null;\n    \n    // Try each endpoint until one succeeds\n    for (const endpoint of possibleEndpoints) {\n      try {\n        console.log(`Attempting signup with endpoint: ${endpoint}`);\n        \n        // Format the data according to what your backend expects\n        // LoginSerializer requires email and password\n        // RegisterSerializer requires email, username, and password\n        const adaptedUserData = {\n          ...userData,\n          // If username is not provided, use email or part of email as username\n          username: userData.username || userData.email.split('@')[0]\n        };\n        \n        const response = await axios.post(endpoint, adaptedUserData);\n        \n        console.log(`Signup successful with endpoint: ${endpoint}`);\n        console.log('Signup response:', response.data);\n        \n        // If signup was successful, return success data\n        return {\n          success: true,\n          data: response.data,\n          message: 'Signup successful! You can now log in.'\n        };\n      } catch (error) {\n        console.error(`Signup failed with endpoint ${endpoint}:`, error.message);\n        lastError = error;\n        // Continue to the next endpoint if this one failed\n      }\n    }\n    \n    // If we've reached this point, all endpoints failed\n    console.error('Signup error:', lastError);\n    console.error('Error details:', lastError.response?.data || lastError.message);\n    \n    // Extract meaningful error message if available\n    let errorMessage = 'Signup failed. Make sure your Django server is running and try again.';\n    if (lastError.response) {\n      if (lastError.response.data.message) {\n        errorMessage = lastError.response.data.message;\n      } else if (lastError.response.data.error) {\n        errorMessage = lastError.response.data.error;\n      } else if (typeof lastError.response.data === 'string') {\n        errorMessage = lastError.response.data;\n      } else if (lastError.response.data.detail) {\n        errorMessage = lastError.response.data.detail;\n      } else if (lastError.response.data.non_field_errors) {\n        errorMessage = lastError.response.data.non_field_errors.join('. ');\n      } else {\n        // Look for field-specific validation errors\n        const validationErrors = [];\n        for (const field in lastError.response.data) {\n          if (Array.isArray(lastError.response.data[field])) {\n            validationErrors.push(`${field}: ${lastError.response.data[field].join('. ')}`);\n          }\n        }\n        if (validationErrors.length > 0) {\n          errorMessage = validationErrors.join('. ');\n        }\n      }\n    }\n    \n    throw new Error(errorMessage);\n  } catch (error) {\n    console.error('Signup error:', error);\n    throw new Error(error.message || 'Signup failed. Check server connection.');\n  }\n};\n\n// User profile\nexport const getUserProfile = async () => {\n  try {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      throw new Error('Authentication required');\n    }\n\n    // Determine the correct authentication header based on token format\n    let headers = {};\n    if (token.startsWith('eyJ')) {\n      // For JWT, try direct token approach (no prefix)\n      headers.Authorization = token;\n      console.log('getUserProfile: Using direct JWT token (no prefix)');\n    } else {\n      // Use Token format for other types\n      headers.Authorization = `Token ${token}`;\n      console.log('getUserProfile: Using Django REST Framework Token format');\n    }\n\n    // Try multiple profile endpoints that might exist\n    const possibleEndpoints = [\n      '/apiV1/profile/',\n      '/apiV1/user/profile/',\n      '/apiV1/user/',\n      '/api/auth/profile/',\n      '/api/auth/user/',\n      '/api/user/profile/',\n      '/api/user/',\n      '/api/profile/',\n      '/api/me/',\n      '/admin/'  // Try admin endpoint as a test for authentication\n    ];\n    \n    let lastError = null;\n    let userData = null;\n    \n    // Try each endpoint until one works\n    for (const endpoint of possibleEndpoints) {\n      try {\n        console.log(`Trying to fetch profile from ${endpoint}`);\n        const response = await api.get(endpoint, { headers });\n        \n        if (response.status === 200 && response.data) {\n          console.log(`Profile found at ${endpoint}:`, response.status);\n          userData = response.data;\n          break;\n        }\n      } catch (endpointError) {\n        console.log(`Profile not found at ${endpoint}:`, \n          endpointError.response ? endpointError.response.status : 'network error');\n        lastError = endpointError;\n        // Continue to the next endpoint\n      }\n    }\n    \n    // If we found user data from any endpoint\n    if (userData) {\n      console.log('Profile data found:', Object.keys(userData).join(', '));\n      \n      // Store key user info in session storage for fallback\n      if (userData.email) {\n        sessionStorage.setItem('lastLoginEmail', userData.email);\n      }\n      \n      if (userData.name) {\n        sessionStorage.setItem('userName', userData.name);\n      } else if (userData.username) {\n        sessionStorage.setItem('userName', userData.username);\n      } else if (userData.first_name) {\n        const fullName = userData.last_name \n          ? `${userData.first_name} ${userData.last_name}`\n          : userData.first_name;\n        sessionStorage.setItem('userName', fullName);\n      }\n      \n      return userData;\n    }\n    \n    // If we get here, no endpoints worked but we have a token\n    // Create a fallback profile based on stored session data\n    console.log('No profile endpoints successful, using fallback data');\n    const email = sessionStorage.getItem('lastLoginEmail');\n    const name = sessionStorage.getItem('userName');\n    \n    if (email) {\n      return {\n        email: email,\n        name: name || 'User',\n        profile_picture: null,\n      };\n    }\n    \n    // If we have no email, re-throw the last error\n    throw lastError || new Error('Failed to fetch profile from all endpoints');\n  } catch (error) {\n    console.error('Error fetching user profile:', \n      error.response ? `${error.response.status}: ${JSON.stringify(error.response.data)}` : error.message);\n    \n    // Create a fallback user object if profile fetch fails\n    const email = sessionStorage.getItem('lastLoginEmail');\n    if (email) {\n      return {\n        email: email,\n        name: sessionStorage.getItem('userName') || 'User',\n        profile_picture: null,\n      };\n    }\n    throw error;\n  }\n};\n\n// Directories\nexport const getDirectories = async () => {\n  try {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      throw new Error('Authentication required');\n    }\n\n    // Try with trailing slash first (Django often requires this)\n    const response = await api.get('/apiV1/directories/', {\n      headers: {\n        Authorization: `Token ${token}`, // Using Token format for Django REST Framework\n      },\n    });\n\n    console.log('Directories response:', response.status, response.data);\n    return response.data;\n  } catch (error) {\n    // If we get a 404 with trailing slash, try without\n    if (error.response && error.response.status === 404) {\n      try {\n        const response = await api.get('/apiV1/directories', {\n          headers: {\n            Authorization: `Token ${token}`,\n          },\n        });\n        console.log('Directories response (without trailing slash):', response.status, response.data);\n        return response.data;\n      } catch (retryError) {\n        console.error('Error fetching directories (retry):', retryError.response ? retryError.response.status : retryError.message);\n        throw retryError;\n      }\n    }\n\n    console.error('Error fetching directories:', error.response ? error.response.status : error.message);\n    \n    // Return some mock directory data if the API fails\n    return [\n      { id: 1, name: 'Documents', path: '/documents', color: '#4285F4' },\n      { id: 2, name: 'Images', path: '/images', color: '#34A853' },\n      { id: 3, name: 'Projects', path: '/projects', color: '#FBBC05' },\n      { id: 4, name: 'Reports', path: '/reports', color: '#EA4335' },\n    ];\n  }\n};\n\n// Chat API Functions\nexport const getChatHistory = async () => {\n  try {\n    // For initial implementation, we'll create a welcome message\n    return [\n      {\n        id: 'welcome',\n        sender: 'bot',\n        content: 'Welcome to FarmSphere.AI, your intelligent farming assistant. How can I help you today?',\n        timestamp: new Date().toISOString()\n      }\n    ];\n  } catch (error) {\n    console.error('Error fetching chat history:', error);\n    return [];\n  }\n};\n\nexport const sendChatMessage = async (message) => {\n  try {\n    const token = localStorage.getItem('token');\n    \n    // Log token status for debugging\n    console.log('Sending chat message with token:', token ? 'Token exists' : 'No token');\n    \n    // Set up headers with proper authentication\n    let headers = {};\n    if (token) {\n      if (token.startsWith('eyJ')) {\n        headers.Authorization = `Bearer ${token}`;\n        console.log('Using JWT Bearer token format');\n      } else {\n        headers.Authorization = `Token ${token}`;\n        console.log('Using Django Token format');\n      }\n    }\n    \n    // Log the actual authorization header for debugging\n    console.log('Authorization header:', headers.Authorization || 'None');\n    \n    // Make request with explicit full URL to avoid any path issues\n    const response = await axios.post(\n      'http://127.0.0.1:8000/apiV1/chat/', \n      { message }, \n      { headers }\n    );\n    \n    console.log('Chat response received:', response.data);\n    \n    return {\n      content: response.data.response,\n      sender: 'bot',\n      timestamp: response.data.timestamp || new Date().toISOString()\n    };\n  } catch (error) {\n    console.error('Error sending chat message:', error);\n    \n    // Check for specific auth errors and handle appropriately\n    if (error.response && error.response.status === 401) {\n      console.warn('Authentication failed - you may need to log in again');\n      // Optional: Redirect to login or reset auth state\n      // localStorage.removeItem('token');\n      // window.location.href = '/login';\n    }\n    \n    throw new Error('Failed to send message. Please try again.');\n  }\n};\n\n// Function to diagnose API endpoints\nexport const checkApiEndpoints = async () => {\n  const token = localStorage.getItem('token');\n  if (!token) {\n    console.error('No authentication token available');\n    return { authenticated: false, endpoints: [] };\n  }\n  \n  // Prepare headers\n  const headers = {\n    Authorization: `Token ${token}`,\n  };\n  \n  // List of endpoints to test\n  const endpoints = [\n    // Common API endpoints\n    { method: 'GET', url: '/api/auth/profile/' },\n    { method: 'GET', url: '/api/directories/' },\n    { method: 'GET', url: '/api/chat/' },\n    { method: 'POST', url: '/api/chat/', data: { message: 'test' } },\n    \n    // V1 API endpoints \n    { method: 'GET', url: '/apiV1/profile/' },\n    { method: 'GET', url: '/apiV1/directories/' },\n    { method: 'GET', url: '/apiV1/ping/' },\n    { method: 'POST', url: '/apiV1/chat/', data: { message: 'test' } },\n    \n    // Azure-specific endpoints (if any)\n    { method: 'GET', url: '/apiV1/azure/status/' },\n  ];\n  \n  const results = [];\n  \n  // Test each endpoint\n  for (const endpoint of endpoints) {\n    try {\n      console.log(`Testing ${endpoint.method} ${endpoint.url}...`);\n      \n      const config = {\n        method: endpoint.method,\n        url: endpoint.url,\n        headers: headers,\n        data: endpoint.data || null\n      };\n      \n      const response = await axios(config);\n      \n      results.push({\n        endpoint: endpoint.url,\n        method: endpoint.method,\n        status: response.status,\n        available: true,\n        data: typeof response.data === 'object' ? 'Object received' : 'Data received'\n      });\n      \n      console.log(`✅ ${endpoint.method} ${endpoint.url} - Status: ${response.status}`);\n    } catch (error) {\n      results.push({\n        endpoint: endpoint.url,\n        method: endpoint.method,\n        status: error.response?.status || 'Network Error',\n        available: false,\n        error: error.response?.data || error.message\n      });\n      \n      console.log(`❌ ${endpoint.method} ${endpoint.url} - Error: ${error.response?.status || error.message}`);\n    }\n  }\n  \n  // Log the summary\n  const availableEndpoints = results.filter(e => e.available);\n  console.log(`API Endpoint Check Summary: ${availableEndpoints.length}/${endpoints.length} endpoints available`);\n  console.table(results);\n  \n  return {\n    authenticated: true,\n    endpoints: results,\n    availableCount: availableEndpoints.length,\n    totalCount: endpoints.length\n  };\n};\n\n/**\n * Tests a specific endpoint and returns detailed status information\n * @param {string} endpoint - The endpoint path to test (e.g., '/api/chat/')\n * @returns {Object} - Object containing status information\n */\nexport const testEndpoint = async (endpoint) => {\n  const baseUrl = 'http://127.0.0.1:8000'; // Django backend URL\n  const url = `${baseUrl}${endpoint}`;\n  \n  try {\n    // Get token if available and use appropriate format\n    const token = localStorage.getItem('token');\n    let headers = {};\n    \n    if (token) {\n      if (token.startsWith('eyJ')) {\n        // For JWT, try direct token approach (no prefix)\n        headers.Authorization = token;\n        console.log('Using direct JWT token (no prefix)');\n      } else {\n        // Other token formats use the Django REST Framework Token format\n        headers.Authorization = `Token ${token}`;\n        console.log('Using Django REST Framework Token format');\n      }\n    }\n    \n    console.log(`Testing endpoint: ${url}`);\n    console.log('Authorization header:', token ? headers.Authorization.substring(0, 15) + '...' : 'None');\n    \n    // For GET endpoints\n    const response = await axios.get(url, { \n      headers,\n      // Don't throw error on non-2xx responses - we want to handle them ourselves\n      validateStatus: () => true\n    });\n    \n    console.log(`Endpoint ${url} response:`, response.status, response.statusText);\n    \n    // A 404 means the server is running but endpoint doesn't exist\n    if (response.status === 404) {\n      return {\n        url,\n        status: 404,\n        available: false,\n        serverRunning: true,\n        message: \"Endpoint not found, but server is running\",\n        data: response.data\n      };\n    }\n    \n    // Auth errors\n    if (response.status === 401 || response.status === 403) {\n      return {\n        url,\n        status: response.status,\n        available: false,\n        authError: true,\n        message: response.status === 401 ? \"Unauthorized - Invalid or missing token\" : \"Forbidden\",\n        data: response.data\n      };\n    }\n    \n    // Success (2xx) responses\n    if (response.status >= 200 && response.status < 300) {\n      return {\n        url,\n        status: response.status,\n        available: true,\n        message: \"Endpoint available\",\n        data: response.data\n      };\n    }\n    \n    // Other responses\n    return {\n      url,\n      status: response.status,\n      available: false,\n      message: `Endpoint responded with: ${response.status} ${response.statusText}`,\n      data: response.data\n    };\n  } catch (error) {\n    console.error(`Error testing endpoint ${url}:`, error);\n    \n    // Network errors (server not running)\n    if (error.code === 'ERR_NETWORK') {\n      return {\n        url,\n        status: 'Network Error',\n        available: false,\n        serverRunning: false,\n        message: \"Server not running or network error\",\n        error: error.message\n      };\n    }\n    \n    return {\n      url,\n      status: error.response?.status || 'Error',\n      available: false,\n      message: `Error: ${error.message}`,\n      error: error.message\n    };\n  }\n};\n\nexport default api;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
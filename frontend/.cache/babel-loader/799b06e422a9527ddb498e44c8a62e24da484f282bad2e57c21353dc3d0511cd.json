{"ast":null,"code":"import axios from 'axios';\n\n// Create an axios instance with the base URL\nconst api = axios.create({\n  baseURL: 'http://localhost:8000',\n  // Updated to correct backend URL\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Request interceptor - adds auth token if available\napi.interceptors.request.use(config => {\n  // Get token from localStorage\n  const token = localStorage.getItem('token');\n\n  // Check if token exists\n  if (token) {\n    console.log(`API Request: Using token for ${config.url}`);\n\n    // Check if the token starts with \"eyJ\" which indicates it's likely a JWT\n    if (token.startsWith('eyJ')) {\n      // The token itself is already the JWT value, no need to prefix it\n      config.headers.Authorization = `Bearer ${token}`;\n      console.log('Using Bearer JWT format');\n    } else {\n      // Use Token format for other token types\n      config.headers.Authorization = `Token ${token}`;\n    }\n\n    // Debugging log\n    console.log('Authorization header:', config.headers.Authorization.substring(0, 15) + '...');\n  } else {\n    console.log('API Request: No token found');\n  }\n  return config;\n}, error => {\n  console.error('Request interceptor error:', error);\n  return Promise.reject(error);\n});\n\n// Response interceptor - handles auth errors\napi.interceptors.response.use(response => {\n  return response;\n}, error => {\n  // Handle 401 Unauthorized errors\n  if (error.response && error.response.status === 401) {\n    console.error('401 Unauthorized error from API:', {\n      url: error.config.url,\n      method: error.config.method,\n      headers: error.config.headers.Authorization ? error.config.headers.Authorization.substring(0, 15) + '...' : 'none'\n    });\n  }\n  return Promise.reject(error);\n});\n\n// Auth functions\nexport const loginUser = async credentials => {\n  try {\n    console.log('API: Sending login request with:', credentials.email);\n    const response = await api.post('/api/auth/login/', credentials);\n    console.log('API: Login response status:', response.status);\n\n    // Store the token properly based on the response format\n    if (response.data) {\n      console.log('Login response data structure:', Object.keys(response.data).join(', '));\n      let token = null;\n\n      // Check different possible token formats in the response\n      if (response.data.token) {\n        token = response.data.token;\n        console.log('Found token in response.data.token');\n      } else if (response.data.access) {\n        // Some APIs return { access: \"token\" } for JWT\n        token = response.data.access;\n        console.log('Found token in response.data.access');\n      } else if (response.data.key) {\n        // Django Rest Auth often returns { key: \"token\" }\n        token = response.data.key;\n        console.log('Found token in response.data.key');\n      } else if (typeof response.data === 'string') {\n        // Some APIs just return the token as a string\n        token = response.data;\n        console.log('Found token as string response');\n      } else {\n        // Try to find any property that might be a token\n        for (const key in response.data) {\n          const value = response.data[key];\n          if (typeof value === 'string' && (value.length > 20 || value.startsWith('eyJ'))) {\n            token = value;\n            console.log(`Found possible token in response.data.${key}`);\n            break;\n          }\n        }\n      }\n      if (token) {\n        // Log token format and beginning to help debug\n        console.log('Token format check:');\n        console.log('- Length:', token.length);\n        console.log('- Starts with:', token.substring(0, 10) + '...');\n        console.log('- Appears to be JWT:', token.startsWith('eyJ'));\n\n        // Store the token\n        localStorage.setItem('token', token);\n\n        // Also store user ID if available for profile access\n        if (response.data.user_id) {\n          sessionStorage.setItem('userId', response.data.user_id);\n        } else if (response.data.id) {\n          sessionStorage.setItem('userId', response.data.id);\n        } else if (response.data.user && response.data.user.id) {\n          sessionStorage.setItem('userId', response.data.user.id);\n        }\n\n        // Store email for fallback identification\n        sessionStorage.setItem('lastLoginEmail', credentials.email);\n\n        // Check if name is included in response and store it\n        if (response.data.name) {\n          sessionStorage.setItem('userName', response.data.name);\n        } else if (response.data.username) {\n          sessionStorage.setItem('userName', response.data.username);\n        } else if (response.data.user && response.data.user.name) {\n          sessionStorage.setItem('userName', response.data.user.name);\n        } else if (response.data.user && response.data.user.username) {\n          sessionStorage.setItem('userName', response.data.user.username);\n        }\n        return response.data;\n      } else {\n        console.error('No token found in login response:', response.data);\n        throw new Error('Login failed: No token received');\n      }\n    } else {\n      throw new Error('Login failed: No data received');\n    }\n  } catch (error) {\n    var _error$response, _error$response$data;\n    console.error('API: Login error:', error.message);\n    if (error.response) {\n      console.error('API: Server response:', error.response.data);\n    }\n    throw new Error(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'Login failed. Please try again.');\n  }\n};\nexport const signupUser = async userData => {\n  try {\n    const response = await api.post('/api/auth/signup/', userData);\n    return response.data;\n  } catch (error) {\n    var _error$response2, _error$response2$data;\n    console.error('API: Signup error:', error.message);\n    throw new Error(((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || 'Signup failed. Please try again.');\n  }\n};\n\n// User profile\nexport const getUserProfile = async () => {\n  try {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      throw new Error('Authentication required');\n    }\n\n    // Determine the correct authentication header based on token format\n    const headers = {};\n    if (token.startsWith('eyJ')) {\n      // Looks like a JWT token\n      headers.Authorization = `Bearer ${token}`;\n      console.log('Using Bearer format for JWT token');\n    } else {\n      // Use Token format for other types\n      headers.Authorization = `Token ${token}`;\n      console.log('Using Token format');\n    }\n\n    // Try multiple profile endpoints that might exist\n    const possibleEndpoints = ['/apiV1/profile/', '/api/auth/profile/', '/api/user/profile/', '/api/profile/'];\n    let lastError = null;\n    let userData = null;\n\n    // Try each endpoint until one works\n    for (const endpoint of possibleEndpoints) {\n      try {\n        console.log(`Trying to fetch profile from ${endpoint}`);\n        const response = await api.get(endpoint, {\n          headers\n        });\n        if (response.status === 200 && response.data) {\n          console.log(`Profile found at ${endpoint}:`, response.status);\n          userData = response.data;\n          break;\n        }\n      } catch (endpointError) {\n        console.log(`Profile not found at ${endpoint}:`, endpointError.response ? endpointError.response.status : 'network error');\n        lastError = endpointError;\n        // Continue to the next endpoint\n      }\n    }\n\n    // If we found user data from any endpoint\n    if (userData) {\n      console.log('Profile data found:', Object.keys(userData).join(', '));\n\n      // Store key user info in session storage for fallback\n      if (userData.email) {\n        sessionStorage.setItem('lastLoginEmail', userData.email);\n      }\n      if (userData.name) {\n        sessionStorage.setItem('userName', userData.name);\n      } else if (userData.username) {\n        sessionStorage.setItem('userName', userData.username);\n      } else if (userData.first_name) {\n        const fullName = userData.last_name ? `${userData.first_name} ${userData.last_name}` : userData.first_name;\n        sessionStorage.setItem('userName', fullName);\n      }\n      return userData;\n    }\n\n    // If we get here, no endpoints worked but we have a token\n    // Create a fallback profile based on stored session data\n    console.log('No profile endpoints successful, using fallback data');\n    const email = sessionStorage.getItem('lastLoginEmail');\n    const name = sessionStorage.getItem('userName');\n    if (email) {\n      return {\n        email: email,\n        name: name || 'User',\n        profile_picture: null\n      };\n    }\n\n    // If we have no email, re-throw the last error\n    throw lastError || new Error('Failed to fetch profile from all endpoints');\n  } catch (error) {\n    console.error('Error fetching user profile:', error.response ? `${error.response.status}: ${JSON.stringify(error.response.data)}` : error.message);\n\n    // Create a fallback user object if profile fetch fails\n    const email = sessionStorage.getItem('lastLoginEmail');\n    if (email) {\n      return {\n        email: email,\n        name: sessionStorage.getItem('userName') || 'User',\n        profile_picture: null\n      };\n    }\n    throw error;\n  }\n};\n\n// Directories\nexport const getDirectories = async () => {\n  try {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      throw new Error('Authentication required');\n    }\n\n    // Try with trailing slash first (Django often requires this)\n    const response = await api.get('/apiV1/directories/', {\n      headers: {\n        Authorization: `Token ${token}` // Using Token format for Django REST Framework\n      }\n    });\n    console.log('Directories response:', response.status, response.data);\n    return response.data;\n  } catch (error) {\n    // If we get a 404 with trailing slash, try without\n    if (error.response && error.response.status === 404) {\n      try {\n        const response = await api.get('/apiV1/directories', {\n          headers: {\n            Authorization: `Token ${token}`\n          }\n        });\n        console.log('Directories response (without trailing slash):', response.status, response.data);\n        return response.data;\n      } catch (retryError) {\n        console.error('Error fetching directories (retry):', retryError.response ? retryError.response.status : retryError.message);\n        throw retryError;\n      }\n    }\n    console.error('Error fetching directories:', error.response ? error.response.status : error.message);\n\n    // Return some mock directory data if the API fails\n    return [{\n      id: 1,\n      name: 'Documents',\n      path: '/documents',\n      color: '#4285F4'\n    }, {\n      id: 2,\n      name: 'Images',\n      path: '/images',\n      color: '#34A853'\n    }, {\n      id: 3,\n      name: 'Projects',\n      path: '/projects',\n      color: '#FBBC05'\n    }, {\n      id: 4,\n      name: 'Reports',\n      path: '/reports',\n      color: '#EA4335'\n    }];\n  }\n};\n\n// Chat API Functions\nexport const getChatHistory = async () => {\n  try {\n    // Since there's no specific chat history endpoint, we'll return an empty array\n    // The Chat component will handle creating the initial welcome message\n    return [];\n  } catch (error) {\n    console.error('Error fetching chat history:', error);\n    return [];\n  }\n};\nexport const sendChatMessage = async message => {\n  try {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      throw new Error('Authentication required');\n    }\n\n    // Special handling for test connection messages\n    if (message === 'test_connection') {\n      console.log('Testing connection to Azure RAG pipeline...');\n      // Try different endpoints to determine if we can connect to the backend\n      try {\n        // First try the profile endpoint as it's more likely to exist\n        const headers = {};\n\n        // Use proper auth format based on token format\n        if (token.startsWith('eyJ')) {\n          headers.Authorization = `Bearer ${token}`;\n        } else {\n          headers.Authorization = `Token ${token}`;\n        }\n        await api.get('/apiV1/profile/', {\n          headers\n        });\n        console.log('Connected to backend via profile endpoint');\n        return {\n          success: true\n        };\n      } catch (profileError) {\n        var _profileError$respons, _profileError$respons2, _profileError$respons3, _profileError$respons4, _profileError$respons5;\n        console.log('Profile endpoint test failed:', (_profileError$respons = profileError.response) === null || _profileError$respons === void 0 ? void 0 : _profileError$respons.status);\n        console.log('Response data:', (_profileError$respons2 = profileError.response) === null || _profileError$respons2 === void 0 ? void 0 : _profileError$respons2.data);\n\n        // If token is invalid, log out the user and throw error\n        if (((_profileError$respons3 = profileError.response) === null || _profileError$respons3 === void 0 ? void 0 : _profileError$respons3.status) === 401 && ((_profileError$respons4 = profileError.response) === null || _profileError$respons4 === void 0 ? void 0 : (_profileError$respons5 = _profileError$respons4.data) === null || _profileError$respons5 === void 0 ? void 0 : _profileError$respons5.detail) === 'Invalid token.') {\n          console.error('Invalid token detected. User needs to log in again.');\n          // Clear the invalid token\n          localStorage.removeItem('token');\n          throw new Error('Session expired. Please log in again.');\n        }\n\n        // Fall back to directories endpoint\n        try {\n          const headers = {};\n\n          // Use proper auth format based on token format\n          if (token.startsWith('eyJ')) {\n            headers.Authorization = `Bearer ${token}`;\n          } else {\n            headers.Authorization = `Token ${token}`;\n          }\n          await api.get('/apiV1/directories/', {\n            headers\n          });\n          console.log('Connected to backend via directories endpoint');\n          return {\n            success: true\n          };\n        } catch (dirError) {\n          var _dirError$response;\n          console.log('Directories endpoint test failed:', (_dirError$response = dirError.response) === null || _dirError$response === void 0 ? void 0 : _dirError$response.status);\n\n          // Last attempt with a simple chat message\n          try {\n            // Try a simple message to test if chat works\n            const headers = {};\n\n            // Use proper auth format based on token format\n            if (token.startsWith('eyJ')) {\n              headers.Authorization = `Bearer ${token}`;\n            } else {\n              headers.Authorization = `Token ${token}`;\n            }\n            const testResponse = await api.post('/apiV1/chat/', {\n              message: \"test\"\n            }, {\n              headers\n            });\n            console.log('Chat endpoint test successful');\n            return {\n              success: true\n            };\n          } catch (chatError) {\n            var _chatError$response;\n            console.error('All connection tests failed:', ((_chatError$response = chatError.response) === null || _chatError$response === void 0 ? void 0 : _chatError$response.status) || chatError.message);\n            throw chatError;\n          }\n        }\n      }\n    }\n\n    // Send message to the Azure-powered chat API endpoint\n    console.log('Sending chat message to Azure:', message);\n    const headers = {};\n\n    // Use proper auth format based on token format\n    if (token.startsWith('eyJ')) {\n      headers.Authorization = `Bearer ${token}`;\n    } else {\n      headers.Authorization = `Token ${token}`;\n    }\n    const response = await api.post('/apiV1/chat/', {\n      message: message\n    }, {\n      headers\n    });\n    console.log('Chat API response:', response.status, response.data);\n\n    // Format the response for the UI\n    const aiResponse = {\n      id: Date.now(),\n      content: response.data.response || response.data.message || \"I received your message but couldn't generate a response.\",\n      sender: 'Azure AI',\n      timestamp: new Date().toISOString(),\n      isCurrentUser: false,\n      sources: response.data.sources || []\n    };\n    return {\n      success: true,\n      aiResponse: aiResponse\n    };\n  } catch (error) {\n    var _error$response3, _error$response4;\n    console.error('Error sending chat message:', (_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.status, error.message);\n    console.error('Error details:', ((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.data) || 'No response data');\n\n    // If unauthorized, throw error to redirect to login\n    if (error.response && error.response.status === 401) {\n      var _error$response$data2;\n      // If token is explicitly invalid, clear it\n      if (((_error$response$data2 = error.response.data) === null || _error$response$data2 === void 0 ? void 0 : _error$response$data2.detail) === 'Invalid token.') {\n        localStorage.removeItem('token');\n      }\n      throw new Error('Authentication required');\n    }\n\n    // For test connection, just rethrow\n    if (message === 'test_connection') {\n      throw error;\n    }\n\n    // Create a fallback response\n    const errorResponse = {\n      id: Date.now(),\n      content: \"I'm having trouble connecting to the Azure OpenAI service. Please check your internet connection and try again later.\",\n      sender: 'Azure AI',\n      timestamp: new Date().toISOString(),\n      isCurrentUser: false\n    };\n    return {\n      success: false,\n      aiResponse: errorResponse\n    };\n  }\n};\n\n// Function to diagnose API endpoints\nexport const checkApiEndpoints = async () => {\n  const token = localStorage.getItem('token');\n  if (!token) {\n    console.error('No authentication token available');\n    return {\n      authenticated: false,\n      endpoints: []\n    };\n  }\n\n  // Prepare headers\n  const headers = {\n    Authorization: `Token ${token}`\n  };\n\n  // List of endpoints to test\n  const endpoints = [\n  // Common API endpoints\n  {\n    method: 'GET',\n    url: '/api/auth/profile/'\n  }, {\n    method: 'GET',\n    url: '/api/directories/'\n  }, {\n    method: 'GET',\n    url: '/api/chat/'\n  }, {\n    method: 'POST',\n    url: '/api/chat/',\n    data: {\n      message: 'test'\n    }\n  },\n  // V1 API endpoints \n  {\n    method: 'GET',\n    url: '/apiV1/profile/'\n  }, {\n    method: 'GET',\n    url: '/apiV1/directories/'\n  }, {\n    method: 'GET',\n    url: '/apiV1/ping/'\n  }, {\n    method: 'POST',\n    url: '/apiV1/chat/',\n    data: {\n      message: 'test'\n    }\n  },\n  // Azure-specific endpoints (if any)\n  {\n    method: 'GET',\n    url: '/apiV1/azure/status/'\n  }];\n  const results = [];\n\n  // Test each endpoint\n  for (const endpoint of endpoints) {\n    try {\n      console.log(`Testing ${endpoint.method} ${endpoint.url}...`);\n      const config = {\n        method: endpoint.method,\n        url: endpoint.url,\n        headers: headers,\n        data: endpoint.data || null\n      };\n      const response = await axios(config);\n      results.push({\n        endpoint: endpoint.url,\n        method: endpoint.method,\n        status: response.status,\n        available: true,\n        data: typeof response.data === 'object' ? 'Object received' : 'Data received'\n      });\n      console.log(`✅ ${endpoint.method} ${endpoint.url} - Status: ${response.status}`);\n    } catch (error) {\n      var _error$response5, _error$response6, _error$response7;\n      results.push({\n        endpoint: endpoint.url,\n        method: endpoint.method,\n        status: ((_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : _error$response5.status) || 'Network Error',\n        available: false,\n        error: ((_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : _error$response6.data) || error.message\n      });\n      console.log(`❌ ${endpoint.method} ${endpoint.url} - Error: ${((_error$response7 = error.response) === null || _error$response7 === void 0 ? void 0 : _error$response7.status) || error.message}`);\n    }\n  }\n\n  // Log the summary\n  const availableEndpoints = results.filter(e => e.available);\n  console.log(`API Endpoint Check Summary: ${availableEndpoints.length}/${endpoints.length} endpoints available`);\n  console.table(results);\n  return {\n    authenticated: true,\n    endpoints: results,\n    availableCount: availableEndpoints.length,\n    totalCount: endpoints.length\n  };\n};\nexport default api;","map":{"version":3,"names":["axios","api","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","console","log","url","startsWith","Authorization","substring","error","Promise","reject","response","status","method","loginUser","credentials","email","post","data","Object","keys","join","access","key","value","length","setItem","user_id","sessionStorage","id","user","name","username","Error","_error$response","_error$response$data","message","signupUser","userData","_error$response2","_error$response2$data","getUserProfile","possibleEndpoints","lastError","endpoint","get","endpointError","first_name","fullName","last_name","profile_picture","JSON","stringify","getDirectories","retryError","path","color","getChatHistory","sendChatMessage","success","profileError","_profileError$respons","_profileError$respons2","_profileError$respons3","_profileError$respons4","_profileError$respons5","detail","removeItem","dirError","_dirError$response","testResponse","chatError","_chatError$response","aiResponse","Date","now","content","sender","timestamp","toISOString","isCurrentUser","sources","_error$response3","_error$response4","_error$response$data2","errorResponse","checkApiEndpoints","authenticated","endpoints","results","push","available","_error$response5","_error$response6","_error$response7","availableEndpoints","filter","e","table","availableCount","totalCount"],"sources":["C:/Users/STSC/Downloads/Agent-Backend-main (3)/my-app/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// Create an axios instance with the base URL\r\nconst api = axios.create({\r\n  baseURL: 'http://localhost:8000', // Updated to correct backend URL\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  }\r\n});\r\n\r\n// Request interceptor - adds auth token if available\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    // Get token from localStorage\r\n    const token = localStorage.getItem('token');\r\n    \r\n    // Check if token exists\r\n    if (token) {\r\n      console.log(`API Request: Using token for ${config.url}`);\r\n      \r\n      // Check if the token starts with \"eyJ\" which indicates it's likely a JWT\r\n      if (token.startsWith('eyJ')) {\r\n        // The token itself is already the JWT value, no need to prefix it\r\n        config.headers.Authorization = `Bearer ${token}`;\r\n        console.log('Using Bearer JWT format');\r\n      } else {\r\n        // Use Token format for other token types\r\n        config.headers.Authorization = `Token ${token}`;\r\n      }\r\n      \r\n      // Debugging log\r\n      console.log('Authorization header:', config.headers.Authorization.substring(0, 15) + '...');\r\n    } else {\r\n      console.log('API Request: No token found');\r\n    }\r\n    \r\n    return config;\r\n  },\r\n  (error) => {\r\n    console.error('Request interceptor error:', error);\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Response interceptor - handles auth errors\r\napi.interceptors.response.use(\r\n  (response) => {\r\n    return response;\r\n  },\r\n  (error) => {\r\n    // Handle 401 Unauthorized errors\r\n    if (error.response && error.response.status === 401) {\r\n      console.error('401 Unauthorized error from API:', {\r\n        url: error.config.url,\r\n        method: error.config.method,\r\n        headers: error.config.headers.Authorization ? \r\n          error.config.headers.Authorization.substring(0, 15) + '...' : 'none'\r\n      });\r\n    }\r\n    \r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Auth functions\r\nexport const loginUser = async (credentials) => {\r\n  try {\r\n    console.log('API: Sending login request with:', credentials.email);\r\n    const response = await api.post('/api/auth/login/', credentials);\r\n    console.log('API: Login response status:', response.status);\r\n    \r\n    // Store the token properly based on the response format\r\n    if (response.data) {\r\n      console.log('Login response data structure:', \r\n        Object.keys(response.data).join(', '));\r\n      \r\n      let token = null;\r\n      \r\n      // Check different possible token formats in the response\r\n      if (response.data.token) {\r\n        token = response.data.token;\r\n        console.log('Found token in response.data.token');\r\n      } else if (response.data.access) {\r\n        // Some APIs return { access: \"token\" } for JWT\r\n        token = response.data.access;\r\n        console.log('Found token in response.data.access');\r\n      } else if (response.data.key) {\r\n        // Django Rest Auth often returns { key: \"token\" }\r\n        token = response.data.key;\r\n        console.log('Found token in response.data.key');\r\n      } else if (typeof response.data === 'string') {\r\n        // Some APIs just return the token as a string\r\n        token = response.data;\r\n        console.log('Found token as string response');\r\n      } else {\r\n        // Try to find any property that might be a token\r\n        for (const key in response.data) {\r\n          const value = response.data[key];\r\n          if (typeof value === 'string' && \r\n              (value.length > 20 || value.startsWith('eyJ'))) {\r\n            token = value;\r\n            console.log(`Found possible token in response.data.${key}`);\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      \r\n      if (token) {\r\n        // Log token format and beginning to help debug\r\n        console.log('Token format check:');\r\n        console.log('- Length:', token.length);\r\n        console.log('- Starts with:', token.substring(0, 10) + '...');\r\n        console.log('- Appears to be JWT:', token.startsWith('eyJ'));\r\n        \r\n        // Store the token\r\n        localStorage.setItem('token', token);\r\n        \r\n        // Also store user ID if available for profile access\r\n        if (response.data.user_id) {\r\n          sessionStorage.setItem('userId', response.data.user_id);\r\n        } else if (response.data.id) {\r\n          sessionStorage.setItem('userId', response.data.id);\r\n        } else if (response.data.user && response.data.user.id) {\r\n          sessionStorage.setItem('userId', response.data.user.id);\r\n        }\r\n        \r\n        // Store email for fallback identification\r\n        sessionStorage.setItem('lastLoginEmail', credentials.email);\r\n        \r\n        // Check if name is included in response and store it\r\n        if (response.data.name) {\r\n          sessionStorage.setItem('userName', response.data.name);\r\n        } else if (response.data.username) {\r\n          sessionStorage.setItem('userName', response.data.username);\r\n        } else if (response.data.user && response.data.user.name) {\r\n          sessionStorage.setItem('userName', response.data.user.name);\r\n        } else if (response.data.user && response.data.user.username) {\r\n          sessionStorage.setItem('userName', response.data.user.username);\r\n        }\r\n        \r\n        return response.data;\r\n      } else {\r\n        console.error('No token found in login response:', response.data);\r\n        throw new Error('Login failed: No token received');\r\n      }\r\n    } else {\r\n      throw new Error('Login failed: No data received');\r\n    }\r\n  } catch (error) {\r\n    console.error('API: Login error:', error.message);\r\n    if (error.response) {\r\n      console.error('API: Server response:', error.response.data);\r\n    }\r\n    throw new Error(error.response?.data?.message || 'Login failed. Please try again.');\r\n  }\r\n};\r\n\r\nexport const signupUser = async (userData) => {\r\n  try {\r\n    const response = await api.post('/api/auth/signup/', userData);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('API: Signup error:', error.message);\r\n    throw new Error(error.response?.data?.message || 'Signup failed. Please try again.');\r\n  }\r\n};\r\n\r\n// User profile\r\nexport const getUserProfile = async () => {\r\n  try {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    // Determine the correct authentication header based on token format\r\n    const headers = {};\r\n    if (token.startsWith('eyJ')) {\r\n      // Looks like a JWT token\r\n      headers.Authorization = `Bearer ${token}`;\r\n      console.log('Using Bearer format for JWT token');\r\n    } else {\r\n      // Use Token format for other types\r\n      headers.Authorization = `Token ${token}`;\r\n      console.log('Using Token format');\r\n    }\r\n\r\n    // Try multiple profile endpoints that might exist\r\n    const possibleEndpoints = [\r\n      '/apiV1/profile/',\r\n      '/api/auth/profile/',\r\n      '/api/user/profile/',\r\n      '/api/profile/'\r\n    ];\r\n    \r\n    let lastError = null;\r\n    let userData = null;\r\n    \r\n    // Try each endpoint until one works\r\n    for (const endpoint of possibleEndpoints) {\r\n      try {\r\n        console.log(`Trying to fetch profile from ${endpoint}`);\r\n        const response = await api.get(endpoint, { headers });\r\n        \r\n        if (response.status === 200 && response.data) {\r\n          console.log(`Profile found at ${endpoint}:`, response.status);\r\n          userData = response.data;\r\n          break;\r\n        }\r\n      } catch (endpointError) {\r\n        console.log(`Profile not found at ${endpoint}:`, \r\n          endpointError.response ? endpointError.response.status : 'network error');\r\n        lastError = endpointError;\r\n        // Continue to the next endpoint\r\n      }\r\n    }\r\n    \r\n    // If we found user data from any endpoint\r\n    if (userData) {\r\n      console.log('Profile data found:', Object.keys(userData).join(', '));\r\n      \r\n      // Store key user info in session storage for fallback\r\n      if (userData.email) {\r\n        sessionStorage.setItem('lastLoginEmail', userData.email);\r\n      }\r\n      \r\n      if (userData.name) {\r\n        sessionStorage.setItem('userName', userData.name);\r\n      } else if (userData.username) {\r\n        sessionStorage.setItem('userName', userData.username);\r\n      } else if (userData.first_name) {\r\n        const fullName = userData.last_name \r\n          ? `${userData.first_name} ${userData.last_name}`\r\n          : userData.first_name;\r\n        sessionStorage.setItem('userName', fullName);\r\n      }\r\n      \r\n      return userData;\r\n    }\r\n    \r\n    // If we get here, no endpoints worked but we have a token\r\n    // Create a fallback profile based on stored session data\r\n    console.log('No profile endpoints successful, using fallback data');\r\n    const email = sessionStorage.getItem('lastLoginEmail');\r\n    const name = sessionStorage.getItem('userName');\r\n    \r\n    if (email) {\r\n      return {\r\n        email: email,\r\n        name: name || 'User',\r\n        profile_picture: null,\r\n      };\r\n    }\r\n    \r\n    // If we have no email, re-throw the last error\r\n    throw lastError || new Error('Failed to fetch profile from all endpoints');\r\n  } catch (error) {\r\n    console.error('Error fetching user profile:', \r\n      error.response ? `${error.response.status}: ${JSON.stringify(error.response.data)}` : error.message);\r\n    \r\n    // Create a fallback user object if profile fetch fails\r\n    const email = sessionStorage.getItem('lastLoginEmail');\r\n    if (email) {\r\n      return {\r\n        email: email,\r\n        name: sessionStorage.getItem('userName') || 'User',\r\n        profile_picture: null,\r\n      };\r\n    }\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Directories\r\nexport const getDirectories = async () => {\r\n  try {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    // Try with trailing slash first (Django often requires this)\r\n    const response = await api.get('/apiV1/directories/', {\r\n      headers: {\r\n        Authorization: `Token ${token}`, // Using Token format for Django REST Framework\r\n      },\r\n    });\r\n\r\n    console.log('Directories response:', response.status, response.data);\r\n    return response.data;\r\n  } catch (error) {\r\n    // If we get a 404 with trailing slash, try without\r\n    if (error.response && error.response.status === 404) {\r\n      try {\r\n        const response = await api.get('/apiV1/directories', {\r\n          headers: {\r\n            Authorization: `Token ${token}`,\r\n          },\r\n        });\r\n        console.log('Directories response (without trailing slash):', response.status, response.data);\r\n        return response.data;\r\n      } catch (retryError) {\r\n        console.error('Error fetching directories (retry):', retryError.response ? retryError.response.status : retryError.message);\r\n        throw retryError;\r\n      }\r\n    }\r\n\r\n    console.error('Error fetching directories:', error.response ? error.response.status : error.message);\r\n    \r\n    // Return some mock directory data if the API fails\r\n    return [\r\n      { id: 1, name: 'Documents', path: '/documents', color: '#4285F4' },\r\n      { id: 2, name: 'Images', path: '/images', color: '#34A853' },\r\n      { id: 3, name: 'Projects', path: '/projects', color: '#FBBC05' },\r\n      { id: 4, name: 'Reports', path: '/reports', color: '#EA4335' },\r\n    ];\r\n  }\r\n};\r\n\r\n// Chat API Functions\r\nexport const getChatHistory = async () => {\r\n  try {\r\n    // Since there's no specific chat history endpoint, we'll return an empty array\r\n    // The Chat component will handle creating the initial welcome message\r\n    return [];\r\n  } catch (error) {\r\n    console.error('Error fetching chat history:', error);\r\n    return [];\r\n  }\r\n};\r\n\r\nexport const sendChatMessage = async (message) => {\r\n  try {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      throw new Error('Authentication required');\r\n    }\r\n\r\n    // Special handling for test connection messages\r\n    if (message === 'test_connection') {\r\n      console.log('Testing connection to Azure RAG pipeline...');\r\n      // Try different endpoints to determine if we can connect to the backend\r\n      try {\r\n        // First try the profile endpoint as it's more likely to exist\r\n        const headers = {};\r\n        \r\n        // Use proper auth format based on token format\r\n        if (token.startsWith('eyJ')) {\r\n          headers.Authorization = `Bearer ${token}`;\r\n        } else {\r\n          headers.Authorization = `Token ${token}`;\r\n        }\r\n        \r\n        await api.get('/apiV1/profile/', { headers });\r\n        console.log('Connected to backend via profile endpoint');\r\n        return { success: true };\r\n      } catch (profileError) {\r\n        console.log('Profile endpoint test failed:', profileError.response?.status);\r\n        console.log('Response data:', profileError.response?.data);\r\n        \r\n        // If token is invalid, log out the user and throw error\r\n        if (profileError.response?.status === 401 && \r\n            profileError.response?.data?.detail === 'Invalid token.') {\r\n          console.error('Invalid token detected. User needs to log in again.');\r\n          // Clear the invalid token\r\n          localStorage.removeItem('token');\r\n          throw new Error('Session expired. Please log in again.');\r\n        }\r\n        \r\n        // Fall back to directories endpoint\r\n        try {\r\n          const headers = {};\r\n        \r\n          // Use proper auth format based on token format\r\n          if (token.startsWith('eyJ')) {\r\n            headers.Authorization = `Bearer ${token}`;\r\n          } else {\r\n            headers.Authorization = `Token ${token}`;\r\n          }\r\n          \r\n          await api.get('/apiV1/directories/', { headers });\r\n          console.log('Connected to backend via directories endpoint');\r\n          return { success: true };\r\n        } catch (dirError) {\r\n          console.log('Directories endpoint test failed:', dirError.response?.status);\r\n          \r\n          // Last attempt with a simple chat message\r\n          try {\r\n            // Try a simple message to test if chat works\r\n            const headers = {};\r\n        \r\n            // Use proper auth format based on token format\r\n            if (token.startsWith('eyJ')) {\r\n              headers.Authorization = `Bearer ${token}`;\r\n            } else {\r\n              headers.Authorization = `Token ${token}`;\r\n            }\r\n            \r\n            const testResponse = await api.post('/apiV1/chat/', \r\n              { message: \"test\" },\r\n              { headers }\r\n            );\r\n            console.log('Chat endpoint test successful');\r\n            return { success: true };\r\n          } catch (chatError) {\r\n            console.error('All connection tests failed:', \r\n              chatError.response?.status || chatError.message);\r\n            throw chatError;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // Send message to the Azure-powered chat API endpoint\r\n    console.log('Sending chat message to Azure:', message);\r\n    \r\n    const headers = {};\r\n    \r\n    // Use proper auth format based on token format\r\n    if (token.startsWith('eyJ')) {\r\n      headers.Authorization = `Bearer ${token}`;\r\n    } else {\r\n      headers.Authorization = `Token ${token}`;\r\n    }\r\n    \r\n    const response = await api.post('/apiV1/chat/', {\r\n      message: message\r\n    }, { headers });\r\n\r\n    console.log('Chat API response:', response.status, response.data);\r\n    \r\n    // Format the response for the UI\r\n    const aiResponse = {\r\n      id: Date.now(),\r\n      content: response.data.response || response.data.message || \"I received your message but couldn't generate a response.\",\r\n      sender: 'Azure AI',\r\n      timestamp: new Date().toISOString(),\r\n      isCurrentUser: false,\r\n      sources: response.data.sources || []\r\n    };\r\n    \r\n    return { \r\n      success: true,\r\n      aiResponse: aiResponse\r\n    };\r\n    \r\n  } catch (error) {\r\n    console.error('Error sending chat message:', error.response?.status, error.message);\r\n    console.error('Error details:', error.response?.data || 'No response data');\r\n    \r\n    // If unauthorized, throw error to redirect to login\r\n    if (error.response && error.response.status === 401) {\r\n      // If token is explicitly invalid, clear it\r\n      if (error.response.data?.detail === 'Invalid token.') {\r\n        localStorage.removeItem('token');\r\n      }\r\n      throw new Error('Authentication required');\r\n    }\r\n    \r\n    // For test connection, just rethrow\r\n    if (message === 'test_connection') {\r\n      throw error;\r\n    }\r\n    \r\n    // Create a fallback response\r\n    const errorResponse = {\r\n      id: Date.now(),\r\n      content: \"I'm having trouble connecting to the Azure OpenAI service. Please check your internet connection and try again later.\",\r\n      sender: 'Azure AI',\r\n      timestamp: new Date().toISOString(),\r\n      isCurrentUser: false\r\n    };\r\n    \r\n    return {\r\n      success: false,\r\n      aiResponse: errorResponse\r\n    };\r\n  }\r\n};\r\n\r\n// Function to diagnose API endpoints\r\nexport const checkApiEndpoints = async () => {\r\n  const token = localStorage.getItem('token');\r\n  if (!token) {\r\n    console.error('No authentication token available');\r\n    return { authenticated: false, endpoints: [] };\r\n  }\r\n  \r\n  // Prepare headers\r\n  const headers = {\r\n    Authorization: `Token ${token}`,\r\n  };\r\n  \r\n  // List of endpoints to test\r\n  const endpoints = [\r\n    // Common API endpoints\r\n    { method: 'GET', url: '/api/auth/profile/' },\r\n    { method: 'GET', url: '/api/directories/' },\r\n    { method: 'GET', url: '/api/chat/' },\r\n    { method: 'POST', url: '/api/chat/', data: { message: 'test' } },\r\n    \r\n    // V1 API endpoints \r\n    { method: 'GET', url: '/apiV1/profile/' },\r\n    { method: 'GET', url: '/apiV1/directories/' },\r\n    { method: 'GET', url: '/apiV1/ping/' },\r\n    { method: 'POST', url: '/apiV1/chat/', data: { message: 'test' } },\r\n    \r\n    // Azure-specific endpoints (if any)\r\n    { method: 'GET', url: '/apiV1/azure/status/' },\r\n  ];\r\n  \r\n  const results = [];\r\n  \r\n  // Test each endpoint\r\n  for (const endpoint of endpoints) {\r\n    try {\r\n      console.log(`Testing ${endpoint.method} ${endpoint.url}...`);\r\n      \r\n      const config = {\r\n        method: endpoint.method,\r\n        url: endpoint.url,\r\n        headers: headers,\r\n        data: endpoint.data || null\r\n      };\r\n      \r\n      const response = await axios(config);\r\n      \r\n      results.push({\r\n        endpoint: endpoint.url,\r\n        method: endpoint.method,\r\n        status: response.status,\r\n        available: true,\r\n        data: typeof response.data === 'object' ? 'Object received' : 'Data received'\r\n      });\r\n      \r\n      console.log(`✅ ${endpoint.method} ${endpoint.url} - Status: ${response.status}`);\r\n    } catch (error) {\r\n      results.push({\r\n        endpoint: endpoint.url,\r\n        method: endpoint.method,\r\n        status: error.response?.status || 'Network Error',\r\n        available: false,\r\n        error: error.response?.data || error.message\r\n      });\r\n      \r\n      console.log(`❌ ${endpoint.method} ${endpoint.url} - Error: ${error.response?.status || error.message}`);\r\n    }\r\n  }\r\n  \r\n  // Log the summary\r\n  const availableEndpoints = results.filter(e => e.available);\r\n  console.log(`API Endpoint Check Summary: ${availableEndpoints.length}/${endpoints.length} endpoints available`);\r\n  console.table(results);\r\n  \r\n  return {\r\n    authenticated: true,\r\n    endpoints: results,\r\n    availableCount: availableEndpoints.length,\r\n    totalCount: endpoints.length\r\n  };\r\n};\r\n\r\nexport default api;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}